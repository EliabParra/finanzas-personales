<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categor√≠as - Finanzas Personales</title>
    <link rel="stylesheet" href="src/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Secci√≥n de Navegaci√≥n Principal -->
        <nav class="header">
            <a href="dashboard.html" class="nav-item"><i class="fas fa-home"></i> Dashboard</a>
            <a href="transacciones.html" class="nav-item"><i class="fas fa-exchange-alt"></i> Transacciones</a>
            <a href="categorias.html" class="nav-item active"><i class="fas fa-tags"></i> Categor√≠as</a>
            <a href="presupuestos.html" class="nav-item"><i class="fas fa-chart-pie"></i> Presupuestos</a>
            <a href="analisis.html" class="nav-item"><i class="fas fa-chart-line"></i> An√°lisis</a>
        </nav>

        <!-- Secci√≥n de Gesti√≥n de Categor√≠as -->
        <div class="card" data-aos="fade-up">
            <div class="card-header">
                <h2 class="card-title">Mis Categor√≠as üè∑Ô∏è</h2>
                <button class="btn" id="openCategoryModalBtn"><i class="fas fa-plus-circle"></i> Nueva Categor√≠a</button>
            </div>

            <div class="categories-grid" data-aos="fade-up" data-aos-delay="50">
                <!-- Categor√≠as predefinidas -->
                <div class="category-item" data-category-id="1" data-category-name="Alimentaci√≥n" data-category-icon="fa-utensils" data-category-color="#FF7043">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #FF7043;">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <span class="category-name">Alimentaci√≥n</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <!-- Las categor√≠as predefinidas no deber√≠an ser eliminables, pero se incluye el bot√≥n para ejemplo -->
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="2" data-category-name="Transporte" data-category-icon="fa-bus" data-category-color="#AB47BC">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #AB47BC;">
                            <i class="fas fa-bus"></i>
                        </div>
                        <span class="category-name">Transporte</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="3" data-category-name="Ocio" data-category-icon="fa-film" data-category-color="#26C6DA">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #26C6DA;">
                            <i class="fas fa-film"></i>
                        </div>
                        <span class="category-name">Ocio</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="4" data-category-name="Servicios" data-category-icon="fa-lightbulb" data-category-color="#FFCA28">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #FFCA28;">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <span class="category-name">Servicios</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="5" data-category-name="Salud" data-category-icon="fa-heartbeat" data-category-color="#EF5350">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #EF5350;">
                            <i class="fas fa-heartbeat"></i>
                        </div>
                        <span class="category-name">Salud</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="6" data-category-name="Educaci√≥n" data-category-icon="fa-graduation-cap" data-category-color="#7986CB">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #7986CB;">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <span class="category-name">Educaci√≥n</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="category-item" data-category-id="7" data-category-name="Otros" data-category-icon="fa-ellipsis-h" data-category-color="#9E9E9E">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #9E9E9E;">
                            <i class="fas fa-ellipsis-h"></i>
                        </div>
                        <span class="category-name">Otros</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <!-- Categor√≠a personalizada de ejemplo -->
                <div class="category-item" data-category-id="8" data-category-name="Entretenimiento" data-category-icon="fa-gamepad" data-category-color="#FFD54F">
                    <div class="category-info">
                        <div class="category-icon-wrapper" style="background-color: #FFD54F;">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <span class="category-name">Entretenimiento</span>
                    </div>
                    <div class="category-actions">
                        <button class="category-action-btn edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="category-action-btn delete" title="Eliminar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL PARA AGREGAR/EDITAR CATEGOR√çA -->
    <div class="modal-overlay" id="categoryModal">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeCategoryModalBtn">&times;</button>
            <h3 class="modal-title" id="categoryModalTitle">Nueva Categor√≠a ‚ûï</h3>
            <form id="categoryForm">
                <input type="hidden" id="categoryId"> <!-- Para almacenar el ID de la categor√≠a a editar -->
                <div class="form-group">
                    <label for="categoryName">Nombre de la Categor√≠a</label>
                    <input type="text" id="categoryName" placeholder="Ej: Caf√©, Gimnasio" required>
                </div>
                <div class="form-group">
                    <label for="categoryIcon">Icono (Clase de Font Awesome)</label>
                    <input type="text" id="categoryIcon" placeholder="Ej: fa-coffee, fa-dumbbell" required>
                    <small style="color: var(--text-light); font-size: 0.8em;">Busca iconos en <a href="https://fontawesome.com/icons" target="_blank" style="color: var(--primary-color); text-decoration: none;">Font Awesome</a> (ej: "fa-utensils")</small>
                </div>
                <div class="form-group">
                    <label for="categoryColor">Color</label>
                    <input type="color" id="categoryColor" value="#6a6ee0"> <!-- Color por defecto -->
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-cancel" id="cancelCategoryBtn">Cancelar</button>
                    <button type="submit" class="btn">Guardar Categor√≠a</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Script para AOS (animaciones) -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Inicializar AOS
        AOS.init({
            duration: 800, // Duraci√≥n de la animaci√≥n en ms
            once: true,    // Si las animaciones deben ocurrir solo una vez
        });

        document.addEventListener('DOMContentLoaded', () => {
            const navItems = document.querySelectorAll('.main-nav .nav-item');
            const openCategoryModalBtn = document.getElementById('openCategoryModalBtn');
            const categoryModal = document.getElementById('categoryModal');
            const closeCategoryModalBtn = document.getElementById('closeCategoryModalBtn');
            const cancelCategoryBtn = document.getElementById('cancelCategoryBtn');
            const categoryForm = document.getElementById('categoryForm');
            const categoryModalTitle = document.getElementById('categoryModalTitle');
            const categoryIdInput = document.getElementById('categoryId');
            const categoryNameInput = document.getElementById('categoryName');
            const categoryIconInput = document.getElementById('categoryIcon');
            const categoryColorInput = document.getElementById('categoryColor');
            const categoryEditButtons = document.querySelectorAll('.category-action-btn.edit');
            const categoryDeleteButtons = document.querySelectorAll('.category-action-btn.delete');

            // --- L√≥gica de Navegaci√≥n ---
            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    // e.preventDefault();
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    console.log(`Navegando a: ${item.textContent.trim()}`);
                    // Aqu√≠ ir√≠a tu l√≥gica para cargar el contenido de la vista correspondiente
                });
            });

            // --- L√≥gica del Modal de Categor√≠a ---
            const openModal = (isEdit = false, categoryData = {}) => {
                categoryModal.classList.add('show');
                if (isEdit) {
                    categoryModalTitle.textContent = 'Editar Categor√≠a ‚úèÔ∏è';
                    categoryIdInput.value = categoryData.id;
                    categoryNameInput.value = categoryData.name;
                    categoryIconInput.value = categoryData.icon.replace('fa-', ''); // Quitar 'fa-' para el input
                    categoryColorInput.value = categoryData.color;
                } else {
                    categoryModalTitle.textContent = 'Nueva Categor√≠a ‚ûï';
                    categoryIdInput.value = ''; // Limpiar ID para nueva categor√≠a
                    categoryForm.reset(); // Limpiar el formulario
                    categoryColorInput.value = '#6a6ee0'; // Restaurar color por defecto
                }
            };

            const closeModal = () => {
                categoryModal.classList.remove('show');
                categoryForm.reset();
                categoryIdInput.value = ''; // Asegurarse de que el ID est√© limpio
                categoryColorInput.value = '#6a6ee0'; // Restaurar color por defecto
            };

            openCategoryModalBtn.addEventListener('click', () => openModal(false));
            closeCategoryModalBtn.addEventListener('click', closeModal);
            cancelCategoryBtn.addEventListener('click', closeModal);

            categoryModal.addEventListener('click', (e) => {
                if (e.target === categoryModal) {
                    closeModal();
                }
            });

            // L√≥gica para el env√≠o del formulario de categor√≠a (placeholder)
            categoryForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const id = categoryIdInput.value;
                const name = categoryNameInput.value;
                const icon = categoryIconInput.value;
                const color = categoryColorInput.value;

                const categoryData = { id, name, icon: `fa-${icon}`, color };

                if (id) {
                    console.log('Editando Categor√≠a:', categoryData);
                    alert(`Categor√≠a "${name}" editada con √©xito (simulado)!`);
                    // Aqu√≠ ir√≠a tu l√≥gica para actualizar la categor√≠a en IndexedDB
                } else {
                    console.log('Nueva Categor√≠a:', categoryData);
                    alert(`Categor√≠a "${name}" guardada con √©xito (simulado)!`);
                    // Aqu√≠ ir√≠a tu l√≥gica para guardar la nueva categor√≠a en IndexedDB
                }
                closeModal();
            });

            // --- L√≥gica de botones de Editar Categor√≠a ---
            categoryEditButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const categoryItem = e.currentTarget.closest('.category-item');
                    const categoryData = {
                        id: categoryItem.dataset.categoryId,
                        name: categoryItem.dataset.categoryName,
                        icon: categoryItem.dataset.categoryIcon,
                        color: categoryItem.dataset.categoryColor
                    };
                    openModal(true, categoryData);
                });
            });

            // --- L√≥gica de botones de Eliminar Categor√≠a ---
            categoryDeleteButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const categoryItem = e.currentTarget.closest('.category-item');
                    const categoryId = categoryItem.dataset.categoryId;
                    const categoryName = categoryItem.dataset.categoryName;

                    const confirmDelete = confirm(`¬øEst√°s seguro de que quieres eliminar la categor√≠a "${categoryName}"? (Simulado) Esto tambi√©n eliminar√° las transacciones asociadas.`);
                    if (confirmDelete) {
                        console.log(`Eliminando categor√≠a con ID: ${categoryId} y nombre: ${categoryName}`);
                        categoryItem.remove(); // Remover del DOM
                        alert(`Categor√≠a "${categoryName}" eliminada (simulado)!`);
                        // Aqu√≠ ir√≠a tu l√≥gica para eliminar la categor√≠a y sus transacciones de IndexedDB
                    }
                });
            });
        });
    </script>
</body>
</html>
